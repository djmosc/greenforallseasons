!function(e){e.extend({socialdata:function(t,r){var a={init:function(){for(var r=[],s=0;s<t.networks.length;s++){var o=t.networks[s].name;if(n[o]){var u=n[o],l=u.url,p=t.networks[s].id,c=t.networks[s].num?t.networks[s].num:10,m=t.networks[s].page?t.networks[s].page:1;l=l.replace("[id]",p),u.parseXml&&(l=i.replace("[url]",encodeURIComponent(l))),l=l.replace("[num]",c),l=l.replace("[page]",m),r.push(a.request(l))}}r&&e.when.apply(e,r).done(a.loaded)},request:function(t){return e.ajax({type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",url:t})},loaded:function(e){var t=a.unify(arguments);t=a.sortByKey(t,"timestamp"),r(t)},unify:function(e){var r=[];for(var i in t.networks){var s=t.networks[i].name;if(n[s]){var o=n[s],u=t.networks.length>1?e[i][0]:e[i],l=a.getObjectData(u,o.parser.entries);o.parser.name=s;for(var p in l)r.push(a.parseData(l[p],o.parser))}}return r},parseData:function(e,t){var r=[],n=[];delete t.entries;for(var i in t){var s=t[i];if(s)if(s instanceof Array)for(var o in s)r[i]=a.getObjectData(e,s[o]);else r[i]=a.getObjectData(e,s)}"number"!=typeof r.timestamp&&(r.timestamp=Date.parse(r.timestamp)/1e3);var u=new Date(1e3*r.timestamp);switch(r.date=a.relativeTime(u),r.network=t.name,n.push(r.network),t.name){case"facebook":r.image_url=a.extractSrc(r.content),r.image_url.indexOf("fbcdn.net")>-1&&(r.image_url=r.image_url.replace("_s.","_o.")),r.image_url.indexOf("external.ak.fbcdn.net/safe_image.php")>-1&&(r.image_url=a.getUrlQuery(r.image_url,"url"));break;case"pinterest":r.image_url=a.extractSrc(r.content);break;case"instagram":r.image_url=a.extractSrc(r.content);break;case"twitter":r.title=r.title.replace(/\bhttp[^ ]+/gi,function(e){return'<a href="'+e+'">'+e+"</a>"});break;case"youtube":r.id=a.getUrlQuery(r.url,"v")}return r.class=n.join(" "),r},getObjectData:function(e,t){var r=null;return t?("string"==typeof t&&(t=t.split(".")),"undefined"!=typeof(value=e[t[0]])&&(t.length>1?r=a.getObjectData(value,t.splice(1)):value&&(r=value)),r):e},sortByKey:function(e,t){return e.sort(function(e,r){var a=e[t],n=r[t];return parseInt(n)-parseInt(a)})},relativeTime:function(e){var t=Date.parse(e),r=arguments.length>1?arguments[1]:new Date,a=parseInt((r.getTime()-t)/1e3);return 60>a?"less than a minute ago":120>a?"about a minute ago":2700>a?parseInt(a/60).toString()+" minutes ago":5400>a?"about an hour ago":86400>a?"about "+parseInt(a/3600).toString()+" hours ago":172800>a?"1 day ago":parseInt(a/86400).toString()+" days ago"},extractSrc:function(t){var r=e(e.parseHTML(e.trim(t))),a=e("img",r).attr("src");return a},getUrlQuery:function(e,t){var r=e.split("?");if(r[1])for(var a=r[1].split("&"),n=0;n<a.length;n++){var i=a[n].split("=");if(i[0]===t)return decodeURIComponent(i[1])}return e}},n={facebook:{url:"http://www.facebook.com/feeds/page.php?id=[id]&format=rss20",parseXml:!0,parser:{entries:"responseData.feed.entries",id:"id",image_url:"",video:"",title:"title",content:"content",timestamp:"publishedDate",url:"link"}},tumblr:{url:"http://[id].tumblr.com/api/read/json?callback=?&num=[num]",parseXml:!1,parser:{entries:"posts",id:"id",image_url:"photo-url-400",video:"video-source",title:["regular-title","photo-caption"],content:["conversation-text","regular-body","link-description","regular-title","photo-caption","video-caption"],timestamp:"unix-timestamp",url:"url"}},pinterest:{url:"https://www.pinterest.com/[id]/feed.rss",parseXml:!0,parser:{entries:"responseData.feed.entries",id:"id",image_url:"",video:"",title:"title",content:"content",timestamp:"publishedDate",url:"link"}},instagram:{url:"http://ink361.com/feed/user/[id]",parseXml:!0,parser:{entries:"responseData.feed.entries",id:"id",image_url:"",video:"",title:"title",content:"content",timestamp:"publishedDate",url:"link"}},twitter:{url:baseUrl+"/twitter/[id]?count=[num]",parseXml:!1,parser:{entries:"",id:"id",title:"text",timestamp:"created_at"}},youtube:{url:"http://gdata.youtube.com/feeds/base/users/[id]/uploads?alt=rss&v=2",parseXml:!0,parser:{entries:"responseData.feed.entries",id:"id",url:"link",title:"title",timestamp:"publishedDate"}}},i="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=[num]&callback=?&q=[url]";a.init()}})}(jQuery);